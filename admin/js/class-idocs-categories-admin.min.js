class IDOCS_CategoriesAdmin{constructor(){this.addTagForm=jQuery("#addtag");var e=jQuery("#idocs-category-taxo-kb-div"),t=jQuery(".term-parent-wrap"),i=e.clone();e.remove(),i.insertBefore(t),this.wpBulkActions=jQuery(".bulkactions"),this.kb_id=0,this.setupKBFilterSelection(),this.submitButton=jQuery("#submit"),this.submitButton.hide(0),this.submitButton.before("<button type='button' id='idocs-submit' class='button button-primary'>Add New Category</button>"),this.idocSubmit=jQuery("#idocs-submit"),this.selectedKB=jQuery("#idocs-category-taxo-kb"),this.parentCategorySelection=jQuery("#parent"),this.events(),this.updateCategorySelection()}events(){this.idocSubmit.on("click",this.automatedSlug.bind(this)),this.selectedKB.on("change",this.updateCategorySelection.bind(this))}adjustKBLink(){this.kb_id=this.kbSelectionField.val();var e=idocs_ajax_obj.root_url+"/wp-admin/edit-tags.php?taxonomy=idocs-category-taxo&post_type=idocs_content&selected_kb="+this.kb_id;this.urlFilterLink.attr("href",e)}setupKBFilterSelection(){var e=this;jQuery.ajax({url:idocs_ajax_obj.ajax_url,type:"post",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",idocs_ajax_obj.nonce)},data:{action:"update_div_kb_filter"},success:function(t){jQuery(t.content).appendTo(e.wpBulkActions[0]),e.filterSelectedKB=jQuery("#filter-selected-kb"),e.kbSelectionField=jQuery("#kb-selection-field"),e.urlFilterLink=jQuery("#url-filter-link"),e.kbSelectionField.on("input",e.adjustKBLink.bind(e))}})}automatedSlug(e){var t=jQuery("#tag-name").val(),i=jQuery("#tag-slug").val(),n=this.selectedKB.val();if(0!=i.length){this.submitButton.click();return}var o=this;jQuery.ajax({type:"GET",dataType:"json",url:idocs_ajax_obj.root_url+"/wp-json/incredibledocs/v1/check_category_name",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",idocs_ajax_obj.nonce)},data:{term_name:t,term_slug:i,kb_id:n}}).done(function(e){if(e.generate_slug){var i="_".repeat(e.count);jQuery("#tag-slug").val(t.replace(/ /g,"-")+i),o.submitButton.click()}else o.submitButton.click()})}updateCategorySelection(){var e=this.selectedKB.val(),t=this.parentCategorySelection.val();if(null!=e){var i=this;jQuery.ajax({type:"GET",dataType:"json",url:idocs_ajax_obj.root_url+"/wp-json/incredibledocs/v1/categories_per_kb_with_levels",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",idocs_ajax_obj.nonce)},data:{kb_id:e}}).done(function(e){var n,o,a="",s=e.length;i.parentCategorySelection.html("");for(var l="<option value='-1'>None</option>",r=0;r<s;r++){a="",n=parseInt(e[r].level);for(var c=0;c<n;c++)a+="&nbsp;&nbsp;&nbsp;";o="",e[r].term_id==t&&(o=" selected='selected'"),l+="<option class=level-"+e[r].level+" value="+e[r].term_id+o+">"+a+e[r].name+"</option>"}i.parentCategorySelection.html(l)})}}}const instance_IDOCS_CategoriesAdmin=new IDOCS_CategoriesAdmin;