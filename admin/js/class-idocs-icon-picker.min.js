class IDOCS_IconPicker{constructor(){this.icons=[],this.filtered_icons=[],this.loadIcons(),this.iconsPerRow=6,this.lastIcon=null,this.iconPickerButton=jQuery("#icon-picker-button"),this.iconPickerButton.addClass("idocs-button-selected"),this.customIconButton=jQuery("#custom-icon-button"),this.iconPickerFormField=jQuery("#icon-picker-form-field"),this.iconUploadFormField=jQuery("#icon-upload-form-field"),this.iconPickerContainer=jQuery(".idocs-icon-picker-container"),this.searchField=jQuery("#idocs-icon-search-term"),this.typingTimer,this.configuredTimer=700,this.events()}events(){this.iconPickerButton.on("click",this.switchIconInputOption.bind(this)),this.customIconButton.on("click",this.switchIconInputOption.bind(this)),this.searchField.on("keyup",this.typingLogic.bind(this))}typingLogic(){this.searchField.val()!=this.previousValue&&(clearTimeout(this.typingTimer),this.searchField.val()?this.typingTimer=setTimeout(this.searchIcons.bind(this),this.configuredTimer):(this.filtered_icons=[...this.icons],this.createIconRows(),this.handleSavedIcon())),this.previousValue=this.searchField.val()}searchIcons(){this.filtered_icons=[];let i=this.searchField.val();this.filtered_icons=this.icons.filter(t=>{let e=i.toLowerCase(),c=t.icon_key.toLowerCase().startsWith(e),o=t.search_tags.some(i=>i.toLowerCase().startsWith(e));return c||o}),this.createIconRows(),this.handleSavedIcon()}switchIconInputOption(i){var t=i.currentTarget;switch(t.id){case"icon-picker-button":this.iconPickerFormField.show(),this.iconUploadFormField.hide(),this.iconPickerButton.addClass("idocs-button-selected"),this.customIconButton.removeClass("idocs-button-selected"),jQuery(".idocs-category-icon-image").attr("src",""),jQuery(".idocs-category-icon-image-container").hide(),jQuery(".category-icon-image-url").val("");break;case"custom-icon-button":this.iconPickerFormField.hide(),this.iconUploadFormField.show(),this.iconPickerButton.removeClass("idocs-button-selected"),this.customIconButton.addClass("idocs-button-selected")}}loadIcons(){var i=this;jQuery.ajax({type:"GET",dataType:"json",url:idocs_ajax_obj.root_url+"/wp-json/incredibledocs/v1/get_icons",beforeSend:function(i){i.setRequestHeader("X-WP-Nonce",idocs_ajax_obj.nonce)},data:{}}).done(function(t){for(var e=0;e<t.length;e++)i.icons.push(t[e]);i.filtered_icons=[...i.icons],i.createIconRows(),i.handleSavedIcon()})}createIconRows(){let i,t=document.getElementById("icon-picker");this.iconPickerContainer.html("");for(let e=0;e<this.filtered_icons.length;e++){e%this.iconsPerRow==0&&((i=document.createElement("div")).classList.add("idocs-icon-picker-row"),t.appendChild(i));let c=document.createElement("div");c.innerHTML=this.filtered_icons[e].svg_tag,c.classList.add("idocs-icon-picker-icon"),c.setAttribute("id","icon-number-"+e),c.setAttribute("data-icon_key",this.filtered_icons[e].icon_key),c.addEventListener("click",i=>this.handleIconClick(i,this.filtered_icons[e],e)),i.appendChild(c)}}handleIconClick(i,t,e){jQuery("#input-icon-key").val(t.icon_key),null!=this.lastIcon&&jQuery("#icon-number-"+this.lastIcon).removeClass("idocs-icon-picker-icon-active"),jQuery("#icon-number-"+e).addClass("idocs-icon-picker-icon-active"),this.lastIcon=e}handleSavedIcon(){var i=jQuery("#input-icon-key").val();if(""!=i){var t=jQuery("#icon-picker").find('div[data-icon_key="'+i+'"]');if(0!=t.length){t.addClass("idocs-icon-picker-icon-active");var e=t.attr("id").match(/\d+$/)[0];this.lastIcon=e}}}}const instance_IDOCS_IconPicker=new IDOCS_IconPicker;